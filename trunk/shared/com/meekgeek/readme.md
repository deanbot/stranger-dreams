See https://github.com/meekgeek/Meek-FSM